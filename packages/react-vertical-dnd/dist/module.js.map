{"mappings":"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","sources":["packages/react-vertical-dnd/src/reactDragAndDrop.tsx"],"sourcesContent":["// Features I want:\n// + Basic drag and drop\n// + HTML5 dnd\n// + A drag finished callback\n// - The ability to cancel a drag\n// + Axis lock\n// + Lock to the parent component\n// Ideally:\n//\t- Drag and drop between components (Seems difficult...)\n//  + The ability to handle items of multiple sizes\n//  + The ability to handle list mutations (items added, items removed)\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\nconst DRAG_SPEED = 150; //translation transform time in ms\nexport type DragProps = {\n\tstyle: React.CSSProperties;\n\tonDragStart: (event: React.DragEvent<HTMLElement>) => void;\n\tdraggable: \"true\";\n\tref: React.RefCallback<HTMLElement>;\n};\n\ninterface RearrangeableItem {\n\tid: string;\n}\n\ntype ActiveDragInfo = {\n\tid: string;\n\tstartingIndex: number; // The index of the element when the drag started\n\tmouseElementOffset: number; // The offset between element ypos and mouse\n\trestingPosition: number; // The planned position of the element when the drag ends\n\tlastMousePosition: number;\n\trestingPositionItemId: string; // The id of element currently displaced by dragged element\n\tinitialElementBounds: { [id: string]: [yPosition: number, height: number] }; // The bounds of each element when the drag started. Height includes gap\n\tbottomPosition: number; // The lowest possible position of the current dragged element\n};\n\ntype DragAndDropProps<T extends RearrangeableItem> = {\n\titems: T[];\n\trender: ([item, dragProps]: [item: T, props: DragProps, itemIsDragging: boolean][]) => React.ReactElement;\n\tonDragEnd: (fromIndex: number, toIndex: number) => any;\n\tonDragStart?: (item: RearrangeableItem, event: React.DragEvent<HTMLElement>) => any;\n};\n\nfunction getElementYPosition(element: HTMLElement): number {\n\treturn element.getBoundingClientRect().top + window.scrollY;\n}\n\nexport const arrWithReposition = (arr: any[], from: number, to: number) => {\n\tconst result = [...arr];\n\tconst [removed] = result.splice(from, 1);\n\tresult.splice(to, 0, removed);\n\treturn result;\n};\n\nconst DragAndDrop = <T extends RearrangeableItem>({ render, items, onDragEnd, onDragStart }: DragAndDropProps<T>) => {\n\tconst [draggingInfo, setDraggingInfo] = useState<ActiveDragInfo | null>(null);\n\tconst [dragElements, setDragElements] = useState<{ [id: string]: HTMLElement }>({});\n\tconst [elementTranslations, setElementTranslations] = useState<{ [id: string]: number }>({});\n\tconst [DIFT, setDIFT] = useState<{\n\t\tid: string;\n\t\ttimeout: number;\n\t\telement: HTMLElement;\n\t\tnewTranslateY: number;\n\t} | null>(null); // set while dragged item transitions to it's final position using CSS.\n\n\tconst recalculateDraggingInfo = (draggingItemId: string, mouseElementOffset: number) => {\n\t\tconst getElementInitYFromIndex = (index: number) => {\n\t\t\tconst element = dragElements[items[index].id];\n\t\t\tconst translation = elementTranslations[items[index].id] || 0;\n\t\t\treturn getElementYPosition(element) - translation;\n\t\t};\n\t\tconst getElementHeightFromIndex = (index: number) => {\n\t\t\tconst element = dragElements[items[index].id];\n\t\t\treturn element.getBoundingClientRect().height;\n\t\t};\n\n\t\tconst elementIndex = items.findIndex(item => item.id === draggingItemId);\n\t\tconst startingPosition = getElementInitYFromIndex(elementIndex);\n\t\tconst startingIndex = items.map(({ id }) => id).indexOf(draggingItemId);\n\n\t\tconst gap = getElementInitYFromIndex(1) - (getElementInitYFromIndex(0) + getElementHeightFromIndex(0));\n\n\t\tconst initialElementBounds = Object.fromEntries(\n\t\t\titems.map(({ id }, index) => [\n\t\t\t\tid,\n\t\t\t\t[getElementInitYFromIndex(index), getElementHeightFromIndex(index) + gap] as [number, number],\n\t\t\t])\n\t\t);\n\t\tgetElementInitYFromIndex(items.length - 1) + getElementHeightFromIndex(items.length - 1) + gap;\n\n\t\tsetDraggingInfo({\n\t\t\tid: draggingItemId,\n\t\t\tmouseElementOffset,\n\t\t\tstartingIndex,\n\t\t\trestingPositionItemId: draggingItemId,\n\t\t\tlastMousePosition: startingPosition + mouseElementOffset,\n\t\t\trestingPosition: startingPosition,\n\t\t\tinitialElementBounds,\n\t\t\tbottomPosition:\n\t\t\t\tgetElementInitYFromIndex(items.length - 1) +\n\t\t\t\tgetElementHeightFromIndex(items.length - 1) -\n\t\t\t\tgetElementHeightFromIndex(elementIndex),\n\t\t\t// gap,\n\t\t});\n\t\t// handleNewMousePosition(initialMousePosition);\n\t};\n\tconst dragBeginning = (event: React.DragEvent<HTMLElement>, item: RearrangeableItem) => {\n\t\tevent.dataTransfer.setDragImage(document.createElement(\"div\"), 0, 0);\n\t\tif (items.length < 2) return;\n\t\tif (onDragStart) onDragStart(item, event);\n\t\tif (DIFT) {\n\t\t\tclearTimeout(DIFT.timeout);\n\t\t\tsetDIFT(null);\n\t\t}\n\t\trecalculateDraggingInfo(item.id, event.pageY - getElementYPosition(dragElements[item.id]));\n\t};\n\n\tconst handleNewMousePosition = (newMousePostion: number) => {\n\t\tif (!draggingInfo) return;\n\t\tif (newMousePostion == draggingInfo.lastMousePosition) return;\n\t\tlet dragInfoToSet = { ...draggingInfo, lastMousePosition: newMousePostion };\n\t\tconst elementPosition = newMousePostion - draggingInfo.mouseElementOffset;\n\t\tconst [closestPositionItemId] = Object.entries(draggingInfo.initialElementBounds).reduce(\n\t\t\t(closest, [currentId, [currentPosition]]) => {\n\t\t\t\tconst distance = Math.abs(elementPosition - currentPosition);\n\t\t\t\treturn distance < closest[1] ? [currentId, distance] : closest;\n\t\t\t},\n\t\t\t[\"\", Infinity]\n\t\t);\n\t\tlet newElementTranslations = { ...elementTranslations }; // a new object must be created so as to trigger the rerender\n\t\tif (draggingInfo.restingPositionItemId != closestPositionItemId) {\n\t\t\tnewElementTranslations = {};\n\t\t\tconst [restingPosition] = draggingInfo.initialElementBounds[closestPositionItemId];\n\t\t\tdragInfoToSet = { ...dragInfoToSet, restingPositionItemId: closestPositionItemId, restingPosition };\n\t\t\tconst restingPositionIndex = items.findIndex(({ id }) => id === closestPositionItemId);\n\t\t\tconst intermediateItems =\n\t\t\t\trestingPositionIndex > draggingInfo.startingIndex\n\t\t\t\t\t? items.slice(draggingInfo.startingIndex + 1, restingPositionIndex + 1)\n\t\t\t\t\t: items.slice(restingPositionIndex, draggingInfo.startingIndex);\n\t\t\tconst down = restingPositionIndex > draggingInfo.startingIndex;\n\t\t\tintermediateItems.forEach(item => {\n\t\t\t\tnewElementTranslations[item.id] = (down ? -1 : 1) * draggingInfo.initialElementBounds[draggingInfo.id][1];\n\t\t\t});\n\t\t}\n\t\t//axis lock\n\t\tconst top = draggingInfo.initialElementBounds[items[0].id][0];\n\t\tconst bottom = draggingInfo.bottomPosition;\n\n\t\tconst newElementPosition = Math.min(Math.max(elementPosition, top), bottom);\n\t\tnewElementTranslations[draggingInfo.id] =\n\t\t\tnewElementPosition - draggingInfo.initialElementBounds[draggingInfo.id][0];\n\t\t//\n\t\tsetElementTranslations(newElementTranslations);\n\t\tsetDraggingInfo(dragInfoToSet);\n\t};\n\tconst dragEnding = () => {\n\t\tif (!draggingInfo) return;\n\t\tconst element = dragElements[draggingInfo.id];\n\t\tconst [previousTenetY, previousTenetHeight] = draggingInfo.initialElementBounds[draggingInfo.restingPositionItemId];\n\t\tconst newPosition =\n\t\t\telementTranslations[draggingInfo.id] < 0\n\t\t\t\t? previousTenetY\n\t\t\t\t: previousTenetY + previousTenetHeight - draggingInfo.initialElementBounds[draggingInfo.id][1];\n\t\tconst newTranslateY = getElementYPosition(element) - newPosition;\n\t\tsetDIFT({\n\t\t\tid: draggingInfo.id,\n\t\t\ttimeout: setTimeout(() => {\n\t\t\t\tsetDIFT(null);\n\t\t\t\telement.style.transition = \"\";\n\t\t\t}, DRAG_SPEED),\n\t\t\telement,\n\t\t\tnewTranslateY,\n\t\t});\n\t\tsetDraggingInfo(null);\n\t\tonDragEnd(\n\t\t\tdraggingInfo.startingIndex,\n\t\t\titems.findIndex(({ id }) => id === draggingInfo.restingPositionItemId)\n\t\t);\n\t\tsetElementTranslations({});\n\t};\n\n\tconst handleNewMousePositionRef = useRef(handleNewMousePosition);\n\thandleNewMousePositionRef.current = handleNewMousePosition;\n\tconst dragEndingRef = useRef(dragEnding);\n\tdragEndingRef.current = dragEnding;\n\n\tuseEffect(() => {\n\t\tconst handleDragMoving = (event: MouseEvent) => {\n\t\t\tevent.preventDefault(); // Allows drop to occur instantly, rather than after a 0.5s delay (for some reason)\n\t\t\thandleNewMousePositionRef.current(event.pageY);\n\t\t};\n\t\tconst handleDragEnd = () => dragEndingRef.current();\n\t\tdocument.addEventListener(\"dragover\", handleDragMoving);\n\t\tdocument.addEventListener(\"dragend\", handleDragEnd);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"dragover\", handleDragMoving);\n\t\t\tdocument.removeEventListener(\"dragend\", handleDragEnd);\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst itemIds = items.map(item => item.id);\n\t\tconst newDragElements: { [id: string]: HTMLElement } = {};\n\t\tObject.keys(dragElements).forEach(id => {\n\t\t\tif (id in itemIds) newDragElements[id] = dragElements[id];\n\t\t});\n\t\tsetDragElements(newDragElements);\n\t\tif (DIFT) {\n\t\t\tconst { id, element, newTranslateY } = DIFT;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\telement.style.transform = `translateY(${newTranslateY}px)`;\n\t\t\t\telement.style.transition = \"transform 0s\";\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\telement.style.transform = \"\";\n\t\t\t\t\telement.style.transition = `transform ${DRAG_SPEED}ms`;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tif (draggingInfo) recalculateDraggingInfo(draggingInfo?.id, draggingInfo?.mouseElementOffset);\n\t}, [items]);\n\n\tconst renderParameter = items.map((item: T): [T, DragProps, boolean] => {\n\t\tlet itemStyle: { [styleName: string]: string } = {};\n\t\tconst elementIsDragging = draggingInfo?.id === item.id;\n\t\tif (draggingInfo && !elementIsDragging) itemStyle[\"transition\"] = `transform ${DRAG_SPEED}ms`;\n\t\tif (item.id in elementTranslations) itemStyle[\"transform\"] = `translateY(${elementTranslations[item.id]}px)`;\n\n\t\treturn [\n\t\t\titem,\n\t\t\t{\n\t\t\t\tstyle: itemStyle,\n\t\t\t\tonDragStart: (event: React.DragEvent<HTMLElement>) => dragBeginning(event, item),\n\t\t\t\tdraggable: \"true\",\n\t\t\t\tref: (instance: HTMLElement | null) => {\n\t\t\t\t\tdragElements[item.id] = instance!;\n\t\t\t\t},\n\t\t\t},\n\t\t\telementIsDragging,\n\t\t];\n\t});\n\treturn render(renderParameter);\n};\nexport default DragAndDrop;\n"],"names":[],"version":3,"file":"module.js.map"}